<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <title>RICHBOT</title>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&display=swap" rel="stylesheet">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src='//whephiwums.com/sdk.js' data-zone='9006260' data-sdk='show_9006260'></script>
 <style>
   * {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    font-family: 'orbitron', sans-serif;
}
body {
    background: url('https://images.pexels.com/photos/8294554/pexels-photo-8294554.jpeg') no-repeat center center/cover fixed;
    color: white;
    text-align: center;
}
/* Header */
.header {
    background: none;
    padding: 15px;
    font-size: 22px;
    font-weight: bold;
    color: cyan;
    text-shadow: 0 0 10px cyan, 0 0 20px cyan;
}
/* Container utama (di kanan atas) */
.saldo-container {
    position: absolute;
    top: 70px;
    right: 7px;
    display: flex;
    flex-direction: column; /* Susun ke bawah */
    gap: 8px; /* Jarak antar elemen */
}
/* Kotak saldo & reff */
.saldo-box {
    display: flex;
    align-items: baseline;
    background: rgba(0, 0, 0, 0.3); 
    color: white;
    border-radius: 80px;
    padding: 1px 90px;
    box-shadow: 0 0 5px cyan;
    min-width: 130px;
}
/* Ikon */
.saldo-box i {
    font-size: 18px;
    margin-right: 5px;
    margin-left: -90px;
}
/* Teks saldo/reff */
.saldo-text {
    font-size: 14px;
    font-weight: bold;
    margin-right: 3px;
}
/* Angka saldo/reff */
.saldo-amount {
    font-size: 14px;
    font-weight: bold;
    display: flex;
    align-items: center;
    white-space: nowrap; /* Mencegah teks turun ke bawah */
}
/* Supaya angka sejajar dengan Rp */
.saldo-amount span {
    margin-right: 3px; 
}
/* Informasi Pengguna (ID & Username di pojok kiri atas) */
.user-info {
    position: absolute;
    top: 70px;
    left: 10px;
    display: flex;
    flex-direction: column;
    gap: 8px;
}
.user-box {
    background: rgba(0, 0, 0, 0.3);
    padding: 2px;
    border-radius: 80px;
    color: white;
    font-size: 14px;
    display: flex;
    align-items: center;
    gap: 8px;
    min-width: 18px;
    box-shadow: 0 0 6px cyan;
    font-weight: bold;
}
.user-box i {
    color: cyan;
    font-size: 16px;
}
/* Nama di atas Progress Bar */
.user-name {
    text-align: center;
    font-size: 20px;
    font-weight: bold;
    color: white;
    text-shadow: 0 0 8px cyan;
    margin-bottom: 12px;
    position: relative;
    top: 100px;
}
/* Progress Bar */
.progress-container {
    width: 70%;
    display: flex;
    justify-content: space-between;
    margin: 60px auto 10px;
}
 
.progress-bar {
    width: 2%;
    height: 10px;
    background: rgba(255, 255, 255, 0.3);
    border-radius: 2px;
    transition: background 0.3s ease-in-out;
}
.progress-bar.active {
    background: cyan;
    box-shadow: 0 0 6px cyan;
}
 .icon {
    font-size: 10px;
    color: yellow;
    margin: -3 -3px; /* Jarak antara ikon dan progress bar */
}
/* Tombol Iklan Neon */
.triangle-button {
    width: 130px;
    height: 130px;
    background: url('https://static5.depositphotos.com/1004174/395/i/950/depositphotos_3950603-stock-photo-power-button.jpg') 
        no-repeat center center;
    background-size: cover;
    border-radius: 50%;
    display: flex;
    justify-content: center;
    align-items: center;
    cursor: pointer;
    position: fixed; /* Tetap di layar */
    left: 50%;
    top: 65%;
    transform: translate(-50%, -50%); /* Tetap di tengah di semua perangkat */
    transform-origin: center;
    font-size: 24px;
    color: white;
    text-shadow: 0 0 15px cyan;
    transition: box-shadow 0.2s ease-in-out, opacity 0.2s ease-in-out, transform 0.2s ease-in-out;
    box-shadow: 0 0 18px cyan, inset 0 0 10px rgba(0, 255, 255, 0.6);
    animation: glow 1.5s infinite alternate;
    outline: none;
    border: none;
    user-select: none;
    -webkit-tap-highlight-color: transparent;
}
/* Animasi cahaya */
@keyframes glow {
    0% {
        box-shadow: 0 0 12px cyan, inset 0 0 6px rgba(0, 255, 255, 0.4);
    }
    100% {
        box-shadow: 0 0 22px cyan, inset 0 0 15px rgba(0, 255, 255, 0.7);
    }
}
/* Hover & Klik - tidak mengubah posisi */
.triangle-button:hover {
    transform: translate(-50%, -50%) scale(1.05);
    opacity: 0.9;
}
.triangle-button:active {
    transform: translate(-50%, -50%) scale(0.95);
    box-shadow: 0 0 30px cyan, inset 0 0 18px rgba(0, 255, 255, 0.8);
    opacity: 1;
}
/* Disable mode */
/* Mode tombol dinonaktifkan */
#playButton.disabled {
    background-color: gray;
    cursor: not-allowed;
    pointer-events: none;
    filter: brightness(50%); /* Membuat tombol lebih redup tanpa memengaruhi teks anak */
 color: gold;
  font-weight: bold;
}
 
 @keyframes blink {
    0% { opacity: 1; }
    50% { opacity: 0; }
    100% { opacity: 1; }
}

.blink {
    animation: blink 1s infinite; /* Berkedip setiap 1 detik */
}
/* Responsif untuk HP kecil */
@media (max-width: 480px) {
    .triangle-button {
        width: 100px;
        height: 100px;
    }
}
 

/* Navigasi Bawah */
     .nav-bar {
            display: flex;
            justify-content: space-around;
            background: rgba(0, 0, 0, 0.5);
            padding: 12px 0;
            position: fixed;
            bottom: 0;
            width: 100%;
        }
        .nav-item {
            text-align: center;
            color: white;
            cursor: pointer;
         font-size: 28px;
        }
        .nav-item img {
            width: 24px;
            height: 24px;
        }
        .nav-item:hover {
            color: cyan;
        }
        .nav-item p {
            font-size: 14px;
          font-weight: bold;
        }
.nav-item:hover p {
    color: cyan;
}
/* Responsif */
@media (max-width: 600px) {
    .triangle-button {
        width: 100px;
        height: 100px;
        bottom: 150px;
    }
    .saldo-box {
        width: 100px;
    }
    .progress-container {
        width: 85%;
    }
    .nav-item img {
        width: 20px;
        height: 20px;
    }
}
 
 /* Styling Formulir Tarik Dana */
/* Styling untuk form withdraw */
#withdrawSection, #historySection {
 font-family: 'tahoma', sans-serif;
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background: rgba(0, 0, 0, 0.9);
    padding: 20px;
    border-radius: 12px;
    width: 90%;
    max-width: 450px;
    z-index: 1000;
    text-align: center;
    border: 2px solid rgba(255, 215, 0, 0.6);
    box-shadow: 0 0 15px rgba(255, 215, 0, 0.3);
    display: none;
  font-weight: bold;
}

#withdrawSection input {
    width: 100%;
    padding: 10px;
    margin: 5px 0;
    border-radius: 5px;
    border: 1px solid white;
    background: rgba(255, 255, 255, 0.1);
    color: white;
  font-weight: bold;
}

#withdrawSection button, #historySection button {
    background: gold;
    color: black;
    border: none;
    padding: 10px 20px;
    border-radius: 5px;
    cursor: pointer;
    margin-top: 10px;
  font-weight: bold;
}

#withdrawSection h2, #historySection h2 {
    color: gold;
  font-weight: bold;
}

#overlay {
    position: fixed;
    width: 100%;
    height: 100%;
    top: 0;
    left: 0;
    background: rgba(0, 0, 0, 0.5);
    z-index: 999;
    display: none;
}
 /* Kotak riwayat yang bisa digulir */
.history-container {
 font-family: Arial, sans-serif !important; /* Gaya modern & bersih */
    display: flex;
    flex-direction: column; /* Susun ke bawah */
    max-height: 400px;  /* Bisa ditambah agar lebih panjang */
    overflow-y: auto;  /* Scroll jika penuh */
    background: rgba(0, 0, 0, 0.7);
    border: 1px solid gold;
    border-radius: 10px;
    padding: 10px;
    text-align: left;
    margin-top: 10px;
    margin-bottom: 12px;
}

/* Scrollbar agar lebih elegan */
.history-container::-webkit-scrollbar {
    width: 6px;
}

.history-container::-webkit-scrollbar-thumb {
    background: gold;
    border-radius: 5px;
 
}
 .history-entry:nth-child(odd) {
    background: rgba(0, 0, 255, 0.2); /* Biru transparan untuk riwayat ganjil */
}

.history-entry:nth-child(even) {
    background: rgba(255, 165, 0, 0.2); /* Oranye transparan untuk riwayat genap */
}


/* Setiap entri riwayat */
.history-entry {
 font-family: Arial, sans-serif !important; /* Gaya modern & bersih */
    background: rgba(255, 255, 255, 0.1);
    border: 2px solid gold;
    border-radius: 10px;
    padding: 10px;
    margin-bottom: 15px; /* Jarak antar riwayat */
 padding-bottom: 15px;
    display: flex;
    flex-direction: column; /* Agar isi dalam riwayat tersusun ke bawah */
 letter-spacing: 1.5px; /* Atur jarak antar huruf */
 line-height: 2; /* Atur tinggi baris agar lebih rapi */
}
 .history-buttons {
    display: flex;
    justify-content: space-between; /* Biar tombol bersebelahan */
    margin-top: 10px;
}

.history-buttons button {
    background: gold;
    color: black;
    border: none;
    padding: 8px 14px;
    font-size: 14px;
    border-radius: 6px;
    cursor: pointer;
    font-weight: bold;
}

.history-buttons button:hover {
    background: darkgoldenrod;
}
 
 /* Notifikasi Toast */
/* Notifikasi Toast di Atas dengan Transparansi */
.toast {
    visibility: hidden;
    min-width: 250px;
    background: rgba(0, 170, 255, 1); /* Warna biru cyan dengan transparansi */
    color: white;
    text-align: center;
    border-radius: 8px;
    padding: 12px 20px;
    position: fixed;
    left: 50%;
    top: 30px;
    transform: translateX(-50%);
    z-index: 1000;
    font-size: 16px;
    font-weight: bold;
    text-shadow: 0 0 5px rgba(255, 255, 255, 0.6);
    box-shadow: 0 0 10px rgba(0, 170, 255, 0.6), inset 0 0 8px rgba(0, 170, 255, 0.4);
    transition: all 2s ease-in-out;
    animation: pulse 4s infinite alternate;
}

/* Efek Glow Lebih Halus */
@keyframes pulse {
    from {
        box-shadow: 0 0 8px rgba(0, 170, 255, 0.5);
    }
    to {
        box-shadow: 0 0 15px rgba(0, 170, 255, 0.7);
    }
}

/* Efek Muncul & Hilang */
.toast.show {
    visibility: visible;
    top: 70px;
    opacity: 1;
}

.toast.hide {
    top: 30px;
    opacity: 0;
}
 /* Preloader Fullscreen */
#preloader {
    position: fixed;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.85); /* Lebih transparan agar tidak silau */
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    z-index: 9999;
    color: white;
    font-size: 20px;
    text-align: center;
}

/* Teks Loading */
.loading-text {
    font-size: 24px;
    font-weight: bold;
    margin-bottom: 20px;
    animation: fadeInOut 2s infinite;
}

/* Animasi Fade In-Out */
@keyframes fadeInOut {
    0% { opacity: 1; }
    50% { opacity: 0.5; }
    100% { opacity: 1; }
}

/* Progress Bar Container (Preloader) */
.progress-container-preload {
    width: 80%;
    height: 8px;
    background: rgba(255, 255, 255, 0.2);
    border-radius: 5px;
    overflow: hidden;
}

/* Progress Bar (Preloader) */
.progress-bar-preload {
    width: 0%;
    height: 100%;
    background: linear-gradient(90deg, #ff6600, #ff3300); /* Gradasi Oranye-Merah */
    transition: width 10s linear;
}
 
 /* Gaya untuk tampilan panduan full layar */
#guide-content {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: white;
    padding: 20px;
    text-align: center;
    display: none;
    z-index: 1000;
    overflow-y: auto; /* Bisa di-scroll jika isi terlalu panjang */
}

/* Gaya untuk judul panduan */
#guide-content h2 {
    font-size: 24px;
    color: #333;
    margin-top: 20px;
}

/* Gaya untuk teks panduan */
#guide-content p {
    font-size: 18px;
    color: #555;
    text-align: left;
    margin: 15px;
    padding: 10px;
    border-left: 4px solid #007bff;
    background: #f8f9fa;
}

/* Gaya tombol tutup */
#guide-content button {
    position: absolute;
    top: 10px;
    right: 20px;
    background: red;
    color: white;
    border: none;
    padding: 10px 15px;
    font-size: 18px;
    cursor: pointer;
    border-radius: 5px;
}

#guide-content button:hover {
    background: darkred;
}

 /* Styling container tarik saldo reff */
#withdrawReffSection, #reffHistorySection {
    background: #fff;
    padding: 20px;
    border-radius: 10px;
    box-shadow: 0px 4px 8px rgba(0, 0, 0, 0.1);
    text-align: center;
    max-width: 320px;
    margin: 20px auto;
    position: relative;
}

/* Judul utama */
#withdrawReffSection h2, #reffHistorySection h2 {
    font-size: 18px;
    color: #333;
    margin-bottom: 10px;
}

/* Saldo referral */
#saldoReff {
    font-weight: bold;
    color: #27ae60;
}

/* Input jumlah penarikan */
#jumlahTarikReff {
    width: 90%;
    padding: 8px;
    margin: 10px 0;
    border: 1px solid #ccc;
    border-radius: 5px;
    text-align: center;
}

/* Styling tombol */
#withdrawReffSection button, #reffHistorySection button {
    display: block;
    width: 100%;
    padding: 10px;
    margin-top: 10px;
    border: none;
    border-radius: 5px;
    font-size: 14px;
    cursor: pointer;
    transition: 0.3s ease-in-out;
}

/* Tombol utama */
#withdrawReffSection button:first-of-type {
    background: #27ae60;
    color: white;
}

/* Tombol riwayat */
#withdrawReffSection button:nth-of-type(2) {
    background: #3498db;
    color: white;
}

/* Tombol tutup */
#withdrawReffSection button:last-of-type, #reffHistorySection button {
    background: #e74c3c;
    color: white;
}

/* Hover efek */
#withdrawReffSection button:hover, #reffHistorySection button:hover {
    opacity: 0.8;
}
 
 /* Styling daftar riwayat */
#reffHistoryList {
    list-style: none;
    padding: 0;
    max-height: 200px;
    overflow-y: auto;
    margin: 10px 0;
}

/* Item riwayat */
#reffHistoryList li {
    background: #f8f8f8;
    padding: 8px;
    margin-bottom: 5px;
    border-radius: 5px;
    font-size: 14px;
    color: #333;
    text-align: center;
}

/* Scroll untuk daftar panjang */
#reffHistoryList::-webkit-scrollbar {
    width: 5px;
}

#reffHistoryList::-webkit-scrollbar-thumb {
    background: #ccc;
    border-radius: 5px;
}

/* Total Reff Dibawa (di tengah halaman) */
#reffCountBox {
    position: absolute;
    top: 30%;
    left: 50%;
    transform: translate(-50%, -50%);
    font-size: 20px;
    font-weight: bold;
    color: cyan;
    text-align: center;
    white-space: nowrap;
}
 
    </style>
</head>
<body>

    <div class="header">
        RICHBOT v4.0 ü§ñ
    </div>

    <!-- Kotak saldo lebih kecil & turun sedikit -->
  <div class="saldo-container">
        <div class="saldo-box">
            <i>üí∞</i>
            <p class="saldo-text">Saldo:</p>
            <p class="saldo-amount"><span id="saldoCuan">Rp</span></p>
        </div>
        <div class="saldo-box">
            <i>üë•</i>
            <p class="saldo-text">Reff:</p>
            <p class="saldo-amount"><span id="reffCuan">Rp</span></p>
        </div>
    </div>
    
    <!-- ID & Username dalam dua kotak terpisah -->
<div class="user-info">
    <div class="user-box">
        <i>üÜî</i>
        <span id="userId">Memuat...</span>
    </div>
    <div class="user-box">
        <i>üë§</i>
        <span id="username">Memuat...</span>
    </div>
</div>
    <!-- Nama di atas Progress Bar -->
<h2 id="displayName" class="user-name">Memuat...</h2>
 
 
 <div id="toast" class="toast"></div>
 
 <div id="preloader">
    <div class="loading-text">Memuat halaman...</div>
    <div class="progress-container-preload">
        <div class="progress-bar-preload"></div>
    </div>
</div>

    <!-- Progress Bar lebih ke bawah -->
    <div class="progress-container" id="progressContainer">
     <span class="icon">13‚ö°</span>
        <script>
            for (let i = 0; i < 39; i++) {
                document.write('<div class="progress-bar"></div>');
            }
        </script>
             <span class="icon">‚ö°</span>
    </div>
     
     <!-- Total Reff Dibawa (di Tengah Halaman) -->
<div id="reffCountBox">
    <i></i> <span>h</span>
    <span id="reffCount">0</span>
</div>

    <div class="triangle-button" id="playButton" onclick="watchAd()">
    <span id="timerDisplay"></span>
</div>   
    </div>
 
 <!-- Overlay untuk background gelap -->
<div id="overlay" onclick="hideAllSections()"></div>

         <div class="nav-bar">
    <div class="nav-item" onclick="goToHome()">üè†<p>Home</p></div>
    <div class="nav-item" onclick="withdraw()">üí≥<p>Tarik Dana</p></div>          
    <div class="nav-item" onclick="withdrawReff()">üéÅ<p>Tarik Reff</p></div>
    <div class="nav-item" onclick="viewHistory()">üìú<p>Riwayat</p></div>
    <div class="nav-item" onclick="viewGuide()">üìñ<p>Panduan</p></div>
</div>

<div id="withdrawSection" style="display: none;">
    <h2>Tarik Dana</h2>
    <label>Nama DANA:</label>
    <input type="text" id="namaDana" placeholder="Masukkan nama DANA">
    
    <label>No HP DANA:</label>
    <input type="number" id="noDana" placeholder="Masukkan nomor HP DANA">

    <label>Jumlah Penarikan:</label>
    <input type="number" id="jumlahTarik" placeholder="Minimal Rp.1000, kelipatan Rp.1000">
    
    <button onclick="submitWithdraw()">Cairkan</button>
 <button onclick="closeWithdraw()">Tutup</button>
</div>
 
 <!-- Riwayat Penarikan -->
<div id="historySection">
    <h2>üìú Riwayat Penarikan</h2>
    <div id="historyList"></div>
    <div class="history-container" id="historyContainer">
        <!-- Riwayat akan dimasukkan secara dinamis oleh JavaScript -->
    </div>
    <div class="history-buttons">
                 <button onclick="shareToTelegram()">üì§ Share</button>
        <button onclick="hideHistory()">‚ùå Tutup</button>
    </div>
</div>
 
 <!-- Form Penarikan Saldo Reff -->
<div id="withdrawReffSection" style="display: none;">
    <h2>Tarik Saldo Referral</h2>
    <p>Saldo Reff: <span id="saldoReff">0</span> Rp</p>
    
    <label>Jumlah Penarikan:</label>
    <input type="number" id="jumlahTarikReff" placeholder="Minimal Rp.1000, kelipatan Rp.1000">
    
    <button onclick="submitWithdrawReff()">Cairkan ke Saldo</button>
    <button onclick="viewReffHistory()">üìú Riwayat Reff</button>
    <button onclick="closeWithdrawReff()">Tutup</button>
</div>

<!-- Riwayat Penarikan Reff -->
<div id="reffHistorySection" style="display: none;">
    <h2>Riwayat Penarikan Reff</h2>
    <ul id="reffHistoryList"></ul>
    <button onclick="closeReffHistory()">Tutup</button>
</div>

 

<div id="guide-content" style="display:none;">
    <h2>Panduan Penggunaan</h2>
    <p>1. Klik tombol <b>Tonton Iklan</b> untuk mendapatkan saldo.</p>
    <p>2. Minimal saldo untuk tarik dana adalah Rp.1000 dan harus kelipatan Rp.1000.</p>
    <p>3. Penarikan hanya bisa dilakukan sekali per hari.</p>
    <p>4. Saldo akan otomatis ter-reset setiap pukul 00:00.</p>
    <button onclick="closeGuide()">Tutup</button>
</div>

   <script>
document.addEventListener("DOMContentLoaded", function() {
    // Daftar reff khusus
    const reffKhusus = ["user1", "user2", "user3", "user4", "user5"]; // Ganti dengan ID reff yang diizinkan

    function getQueryParam(param) {
        let urlParams = new URLSearchParams(window.location.search);
        return urlParams.get(param);
    }

    // Cek dan simpan reff jika valid
    let reffId = getQueryParam("reff");
    if (reffId && reffKhusus.includes(reffId)) {
        localStorage.setItem("richbot_v4_reff", reffId);
    }

    // Inisialisasi aplikasi
    initRichbot();
});
     let maxAds = 39;
let timerRunning = false; // Cek apakah timer sedang berjalan

function initRichbot() {
    loadUserData();
    displayUserData();
    loadSaldo();
    cekLimit();
    resetHarian();
    loadHistory();

    // Perbarui tampilan saldo dan referral
    document.getElementById("saldoCuan").innerText = "Rp " + getSaldo();
    document.getElementById("reffCuan").innerText = "Rp " + getReffSaldo();
    setReffCount(getReffCount());
}

function loadUserData() {
    let tg = window.Telegram.WebApp;

    // Cek apakah WebApp sudah diinisialisasi dengan benar
    if (tg && tg.initDataUnsafe && tg.initDataUnsafe.user) {
        let user = tg.initDataUnsafe.user;
        let userId = user.id || "Tidak Diketahui";
        let username = user.username ? "@" + user.username : "Tidak Ada Username";
        let name = user.first_name + (user.last_name ? " " + user.last_name : "");

        // Menyimpan data ke localStorage
        localStorage.setItem("richbot_v4_id", userId);
        localStorage.setItem("richbot_v4_username", username);
        localStorage.setItem("richbot_v4_name", name);

        // Tampilkan data pengguna
        displayUserData();
    } else {
        console.log("Data pengguna belum tersedia atau WebApp tidak terinisialisasi dengan benar");
    }
}

function displayUserData() {
    // Pastikan data pengguna ada di localStorage dan tampilkan di elemen yang sesuai
    document.getElementById("userId").innerText = localStorage.getItem("richbot_v4_id") || "Belum Tersimpan";
    document.getElementById("username").innerText = localStorage.getItem("richbot_v4_username") || "Belum Tersimpan";
    document.getElementById("displayName").innerText = localStorage.getItem("richbot_v4_name") || "Belum Tersimpan";
}

function loadSaldo() {
    let saldo = parseInt(localStorage.getItem("richbot_v4_saldo")) || 0;
    let adsWatched = parseInt(localStorage.getItem("richbot_v4_adsWatched")) || 0;

    document.getElementById("saldoCuan").innerText = "Rp " + saldo;
    updateProgressBar(adsWatched);
}

function getSaldo() {
    return parseInt(localStorage.getItem("richbot_v4_saldo")) || 0;
}

function watchAd() {
    let saldoCuan = document.getElementById("saldoCuan");
    let playButton = document.getElementById("playButton");

    let currentAds = parseInt(localStorage.getItem("richbot_v4_adsWatched")) || 0;
    let currentCuan = getSaldo();

    if (currentAds < maxAds && !timerRunning) {
        if (typeof show_9006260 === 'function') {
            show_9006260(); // Menampilkan iklan

            // Setelah iklan diputar, mulai timer
            startTimer(playButton, saldoCuan, currentAds, currentCuan);
        } else {
            showToast("Iklan tidak tersedia saat ini. Silakan coba lagi nanti.");
        }
    } else {
        alert("Limit iklan sudah tercapai hari ini!");
    }
}

function startTimer(playButton, saldoCuan, currentAds, currentCuan) {
    let countdown = 23;
    timerRunning = true;

    let timerDisplay = document.getElementById("timerDisplay");

    playButton.setAttribute("disabled", "true");
    playButton.classList.add("disabled");
    timerDisplay.classList.add("blink");

    let interval = setInterval(() => {
        timerDisplay.innerText = ` ${countdown} `;
        countdown--;

        if (countdown < 0) {
            clearInterval(interval);
            timerRunning = false;
            timerDisplay.innerText = "";
            playButton.removeAttribute("disabled");
            playButton.classList.remove("disabled");
            timerDisplay.classList.remove("blink");

            // Hanya setelah iklan selesai, tambahkan saldo dan jumlah tonton
            currentAds++;
            currentCuan += 13;

            saldoCuan.innerText = "Rp " + currentCuan;
            localStorage.setItem("richbot_v4_saldo", currentCuan);
            localStorage.setItem("richbot_v4_adsWatched", currentAds);
         
               // ‚úÖ Tambahkan bonus Rp.1 ke pemilik reff
            let reffPemilik = localStorage.getItem("richbot_v4_reff");
            if (reffPemilik && reffKhusus.includes(reffPemilik)) {
                let saldoReff = parseInt(localStorage.getItem(`richbot_v4_saldoReff_${reffPemilik}`)) || 0;
                saldoReff += 1;
                localStorage.setItem(`richbot_v4_saldoReff_${reffPemilik}`, saldoReff);
                updateSaldoReff(); // Update tampilan saldo reff
            }

            updateProgressBar(currentAds);
            cekLimit(); // Periksa apakah tombol sudah dibatasi
        }
    }, 1000);
}

function updateProgressBar(adsWatched) {
    let progressBars = document.querySelectorAll(".progress-bar");

    progressBars.forEach((bar, index) => {
        if (index < adsWatched) {
            bar.classList.add("active");
        } else {
            bar.classList.remove("active");
        }
    });
}

function cekLimit() {
    let playButton = document.getElementById("playButton");
    let currentAds = parseInt(localStorage.getItem("richbot_v4_adsWatched")) || 0;

    if (currentAds >= maxAds) {
        playButton.classList.add("disabled");
        playButton.setAttribute("disabled", "true");
    } else {
        playButton.classList.remove("disabled");
        playButton.removeAttribute("disabled");
    }
}

// Fungsi untuk reset harian otomatis (pukul 00:00)
function resetHarianOtomatis() {
    let lastReset = localStorage.getItem("richbot_v4_lastReset");
    let today = new Date().toLocaleDateString();

    if (lastReset === today) {
        console.log("Reset sudah dilakukan hari ini.");
        return; // Jika sudah reset hari ini, hentikan fungsi
    }

    let now = new Date();
    let resetTime = new Date();
    resetTime.setHours(0, 0, 0, 0); // Atur waktu reset ke 00:00

    // Jika sudah melewati 00:00 hari ini, set ke 00:00 besok
    if (now > resetTime) {
        resetTime.setDate(resetTime.getDate() + 1);
    }

    let timeUntilReset = resetTime - now; // Hitung waktu menuju reset

    console.log(`Reset otomatis akan dilakukan dalam ${timeUntilReset / 1000} detik`);

    setTimeout(() => {
        // **Reset jumlah iklan ditonton ke 0**
        localStorage.setItem("richbot_v4_adsWatched", 0);
        localStorage.setItem("richbot_v4_lastReset", today);

        // **Pastikan progress bar ikut diperbarui**
        let currentAds = parseInt(localStorage.getItem("richbot_v4_adsWatched")) || 0;
        updateProgressBar(currentAds); 

        // **Cek ulang tombol play setelah reset**
        cekLimit();

        console.log("Reset otomatis berhasil! Progress bar diperbarui.");
    }, timeUntilReset);
}

// **Jalankan reset otomatis saat halaman dimuat**
resetHarianOtomatis();

function showToast(message, duration = 3000) {
    let toast = document.getElementById("toast");
    toast.innerText = message;
    toast.classList.add("show");

    setTimeout(() => {
        toast.classList.add("hide");
        setTimeout(() => {
            toast.classList.remove("show", "hide");
        }, 500);
    }, duration);
}
// preload halaman awal
document.addEventListener("DOMContentLoaded", function() {
    let progressBarPreload = document.querySelector(".progress-bar-preload");
    let preloader = document.getElementById("preloader");

    progressBarPreload.style.width = "100%"; // Jalankan progress bar

    setTimeout(() => {
        preloader.style.opacity = "0"; // Fade out preloader
        setTimeout(() => {
            preloader.style.display = "none"; // Sembunyikan preloader
        }, 500);
    }, 10000); // Selesai dalam 10 detik
});

let inputs = document.querySelectorAll("input");
inputs.forEach(input => {
    input.addEventListener("focus", () => {
        document.querySelector(".nav-bar").style.display = "none";
    });
    input.addEventListener("blur", () => {
        setTimeout(() => {
            document.querySelector(".nav-bar").style.display = "flex";
        }, 300);
    });
});
function goToHome() {
    // Scroll ke atas dengan efek smooth
    window.scrollTo({ top: 0, behavior: "smooth" });

    // Sembunyikan semua elemen yang sedang terbuka
    document.getElementById("withdrawReffSection").style.display = "none";  // Menutup Tarik Saldo Referral
    document.getElementById("reffHistorySection").style.display = "none";  // Menutup Riwayat Penarikan Referral
 document.getElementById("withdrawSection").style.display = "none";  // Menutup Tarik Saldo Referral
    document.getElementById("historySection").style.display = "none";  // Menutup Riwayat Penarikan Referral

}
function withdraw() {
    let withdrawSection = document.getElementById("withdrawSection");
    
    if (withdrawSection.style.display === "none" || withdrawSection.style.display === "") {
        withdrawSection.style.display = "block"; // Tampilkan formulir
    } else {
        withdrawSection.style.display = "none"; // Sembunyikan formulir
    }
}
 
function submitWithdraw() {
    let nama = document.getElementById("namaDana").value;
    let noDana = document.getElementById("noDana").value;
    let jumlah = parseInt(document.getElementById("jumlahTarik").value);
    let saldo = parseInt(localStorage.getItem("richbot_v4_saldo")) || 0;

    // Validasi input
    if (nama.length < 3) {
        showToast("Nama DANA minimal 3 karakter!");
        return;
    }
    if (noDana.length < 10 || noDana.length > 13) {
        showToast("Nomor HP DANA harus 10-13 digit!");
        return;
    }
    if (jumlah < 1 || jumlah % 1 !== 0) {
        showToast("Jumlah harus minimal Rp.1000 dan kelipatan Rp.1000!");
        return;
    }
    if (jumlah > saldo) {
        showToast("Saldo tidak mencukupi!");
        return;
    }

    // Kurangi saldo
    saldo -= jumlah;
    localStorage.setItem("richbot_v4_saldo", saldo);

    // Ambil data pengguna dari localStorage
    let username = localStorage.getItem("richbot_v4_username") || "Unknown";
    let id = localStorage.getItem("richbot_v4_id") || "Unknown";

    // Simpan riwayat penarikan
    saveHistory(nama, username, id, nama, noDana, jumlah, saldo);

    // Tampilkan notifikasi sukses
    showToast(`Penarikan Rp${formatRupiah(jumlah)} berhasil!`);

    // Kosongkan input setelah sukses
    document.getElementById("namaDana").value = "";
    document.getElementById("noDana").value = "";
    document.getElementById("jumlahTarik").value = "";

    // Perbarui tampilan saldo
    document.getElementById("saldoCuan").innerText = formatRupiah(saldo);

    // Sembunyikan form setelah sukses
    document.getElementById("withdrawSection").style.display = "none";
}

function closeWithdraw() {
    document.getElementById("withdrawSection").style.display = "none";
}

// Fungsi untuk memformat angka ke Rupiah (Rp 1.000.000)
function formatRupiah(angka) {
    return "Rp" + angka.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ".");
}

// Fungsi untuk menyimpan riwayat penarikan ke localStorage
function saveHistory(nama, username, id, namaDana, noDana, jumlah, sisaSaldo) {
    let history = JSON.parse(localStorage.getItem("richbot_v4_history")) || [];
    
    let waktu = new Date();
    let waktuFormat = `${waktu.getDate()}-${waktu.getMonth() + 1}-${waktu.getFullYear()} ${waktu.getHours()}:${waktu.getMinutes()}:${waktu.getSeconds()}`;

    let newEntry = { nama, username, id, namaDana, noDana, jumlah, sisaSaldo, waktu: waktuFormat };
    history.unshift(newEntry); // Tambahkan ke awal array agar terbaru di atas

    localStorage.setItem("richbot_v4_history", JSON.stringify(history));

    loadHistory(); // Perbarui tampilan riwayat
}
function hideHistory() {
    document.getElementById("historySection").style.display = "none";
}

// Fungsi untuk memuat dan menampilkan riwayat penarikan
function loadHistory() {
    let history = JSON.parse(localStorage.getItem("richbot_v4_history")) || [];
    let historyContainer = document.getElementById("historyContainer"); // Gunakan historyList
    historyContainer.innerHTML = ""; // Kosongkan sebelum menambahkan

    if (history.length === 0) {
        historyContainer.innerHTML = "<p>üìÇ Tidak ada riwayat penarikan.</p>";
        return;
    }
 
 

    history.forEach(item => {
        let entry = document.createElement("div");
        entry.classList.add("history-entry");
        entry.innerHTML = `
            <div class="history-top">
            <div class="history-left">
                <p>üë§ <b>${item.nama}</b></p>
            <p>üìõ @${item.username}</p> <!-- Username berada di bawah nama -->
                <p>üÜî ID: ${item.id}</p>
            </div>
     <hr>
     <hr>
            <div class="history-right">
                <p>üí≥ ${item.namaDana}</p>
                <p>üìû ${item.noDana}</p>
                <p>üí∞ ${formatRupiah(item.jumlah)}</p>
            </div>
        </div>
        <hr>
        <div class="history-bottom">
            <p>üí∏ Sisa Saldo: ${formatRupiah(item.sisaSaldo)}</p>
            <p>‚è≥ ${item.waktu}</p>
            <p>üîπ <b>rcbt v.4.0</b></p>
        </div>
        `;
        historyContainer.appendChild(entry);
    });
}


// Fungsi untuk menampilkan/menyembunyikan riwayat penarikan
function viewHistory() {
    let historySection = document.getElementById("historySection");
    
    if (historySection.style.display === "none" || historySection.style.display === "") {
        historySection.style.display = "block";
        loadHistory(); // Muat data saat dibuka
    } else {
        historySection.style.display = "none";
    }
}

function shareToTelegram() {
    let telegramUsername = "Hengki_galih"; // Ganti dengan username Telegram kamu
    let telegramChatURL = `https://t.me/${telegramUsername}`;
    window.open(telegramChatURL, "_blank");
}

function viewGuide() {
    document.getElementById("guide-content").style.display = "block";
}

function closeGuide() {
    document.getElementById("guide-content").style.display = "none";
}

 
function withdrawReff() {
    document.getElementById("withdrawReffSection").style.display = "block";
    document.getElementById("saldoReff").innerText = getReffSaldo();
}

function closeWithdrawReff() {
    document.getElementById("withdrawReffSection").style.display = "none";
}

function getReffSaldo() {
    return parseInt(localStorage.getItem("richbot_v4_reffSaldo")) || 0;
}

function setReffSaldo(amount) {
    localStorage.setItem("richbot_v4_reffSaldo", amount);
    document.getElementById("reffCuan").innerText = "Rp " + amount;
}

function getSaldo() {
    return parseInt(localStorage.getItem("richbot_v4_saldo")) || 0;
}

function setSaldo(amount) {
    localStorage.setItem("richbot_v4_saldo", amount);
    document.getElementById("saldoCuan").innerText = "Rp " + amount;
}

function submitWithdrawReff() {
    let jumlahTarik = parseInt(document.getElementById("jumlahTarikReff").value) || 0;
    let reffSaldo = getReffSaldo();
    let saldoUtama = getSaldo();

    if (jumlahTarik < 1000 || jumlahTarik % 1000 !== 0) {
        showToast("Penarikan harus minimal Rp.1000 dan kelipatan Rp.1000!");
        return;
    }

    if (jumlahTarik > reffSaldo) {
        showToast("Saldo referral tidak mencukupi!");
        return;
    }

    // Update saldo utama & saldo referral
    setReffSaldo(reffSaldo - jumlahTarik);
    setSaldo(saldoUtama + jumlahTarik);

    // Simpan ke riwayat penarikan referral
    saveReffHistory(jumlahTarik);

    showToast("Saldo referral berhasil dipindahkan ke saldo utama!");
    closeWithdrawReff();
}

function saveReffHistory(amount) {
    let history = JSON.parse(localStorage.getItem("richbot_v4_reffHistory")) || [];
    let date = new Date().toLocaleString("id-ID");

    history.unshift({
        amount: amount,
        date: date
    });

    localStorage.setItem("richbot_v4_reffHistory", JSON.stringify(history));
}

function viewReffHistory() {
    let history = JSON.parse(localStorage.getItem("richbot_v4_reffHistory")) || [];
    let historyList = document.getElementById("reffHistoryList");

    historyList.innerHTML = "";
    
    if (history.length === 0) {
        historyList.innerHTML = "<li>Tidak ada riwayat penarikan.</li>";
    } else {
        history.forEach(entry => {
            let listItem = document.createElement("li");
            listItem.textContent = `Rp ${entry.amount} - ${entry.date}`;
            historyList.appendChild(listItem);
        });
    }

    document.getElementById("reffHistorySection").style.display = "block";
}

function closeReffHistory() {
    document.getElementById("reffHistorySection").style.display = "none";
}

 // Fungsi untuk mendapatkan jumlah referral dari localStorage
function getReffCount() {
    return parseInt(localStorage.getItem("richbot_v4_reffCount")) || 0;
}

// Fungsi untuk memperbarui jumlah referral di tampilan
function setReffCount(count) {
    localStorage.setItem("richbot_v4_reffCount", count);
    document.getElementById("reffCount").innerText = count;
}

// Panggil fungsi loadHistory saat halaman dimuat
document.addEventListener("DOMContentLoaded", loadHistory);    </script>

</body>
</html>